language: bash

services:
  - xvfb

env:
  - ARGS="-e 'test7.*'" NEEDS_CSI_S3=true # full mode, excluding test7*
  - ARGS="-i 'test7.*'" NEEDS_CSI_S3=true # full mode, including only test7*
  - ARGS="-l -i 'test7.*' -e test7g"      # lite, including only test7* tests, excluding test7g (as it NEEDS_CSI_S3)
  - ARGS="-l test7g" NEEDS_CSI_S3=true    # lite, only test7g which needs a mounted s3 (that is its purpose)
  - SCRIPT=dashboard.sh

before_install: ./hack/travis/setup.sh
script: bash -c "./tests/bin/${SCRIPT:-test.sh} $ARGS"
after_script: if [[ -f /tmp/gpu-config.json ]]; then ./hack/ibmcloud/delete_vm.sh "$(cat /tmp/gpu-config.json)"; fi
