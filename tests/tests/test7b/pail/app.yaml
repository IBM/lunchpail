{{ if or (not .Values.app) (eq .Values.app "tests") (eq .Values.app "test7b") }}
apiVersion: lunchpail.io/v1alpha1
kind: Application
metadata:
  name: test7b
spec:
  api: workqueue
  code:
  - name: literal.sh
    source: |
      #!/usr/bin/env sh

      # $1 input filepath
      # $2 output filepath
      in="$1"
      out="$2"

      # $xxx and $yyy should come over from the env: specs in app.yaml and pool1.yaml
      echo "Processing $xxx $yyy $in"
      sleep 5

      echo "Done with $in"

  command: ./literal.sh
  image: {{ print .Values.global.image.registry "/" .Values.global.image.repo "/jaas-workerpool-worker-alpine-component:" .Chart.AppVersion }}
# TODO: dataset.py in run controller doesn't currently support adding both as mount and configmap
#  inputs:
#    - sizes:
#        lg: test7bdata
  env:
    xxx: "1111111111"
    yyy: "2222222222"
{{- end }}
