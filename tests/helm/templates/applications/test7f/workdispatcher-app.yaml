{{ if or (not .Values.app) (eq .Values.app "tests") (eq .Values.app "test7f") }}
apiVersion: codeflare.dev/v1alpha1
kind: Application
metadata:
  name: test7f-workdispatcher
  namespace: {{ .Values.namespace }}
spec:
  api: shell
#    https://github.ibm.com/cloud-computer/codeflare-platform/tree/main/platform/dashboard/tests/workdispatcher1
  repo: >-
    https://github.ibm.com/nickm/jaas/tree/workdispatcher-application-2/platform/dashboard/tests/workdispatcher1
  values: >-
    {"taskprefix":{"a":"tasky","b":3333}}

  command: ./main.sh
  image: ghcr.io/project-codeflare/codeflare-s3-syncer-component:dev
  env:
    # main.sh from workdispatcher1 uses $taskprefix and $taskprefix2
    taskprefix: WRONG_YOU_HAVE_A_BUG_IN_WORKDISPATCHER_PY # workdispatcher.yaml should override (via run controller workdispatcher.py)
    taskprefix2: "3333" # this should pass through, since workdispatcher.yaml does not provide an override
{{- end }}
