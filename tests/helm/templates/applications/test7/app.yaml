{{ if or (not .Values.app) (eq .Values.app "tests") (eq .Values.app "test7") }}
apiVersion: codeflare.dev/v1alpha1
kind: Application
metadata:
  name: test7
  namespace: {{ .Values.namespace.user }}
spec:
  api: workqueue
  image: {{ print .Values.global.image.registry "/" .Values.global.image.repo "/jaas-workerpool-worker-alpine-component:" .Values.global.image.version }}
#  repo: https://github.ibm.com/cloud-computer/codeflare-platform/tree/main/tests/helm/templates/applications/test7
  repo: https://github.ibm.com/nickm/codeflare-platform/tree/shrinkwrap-app-from-git/tests/helm/templates/applications/test7
  command: ./src/main.sh
  securityContext:
    runAsUser: 2000 # lunchpail, same as is specified Dockerfile
    runAsGroup: 0 # root, ibid

# TODO: dataset.py in run controller doesn't currently support adding both as mount and configmap
#  inputs:
#    - sizes:
#        lg: test7data
{{- end }}
